<!DOCTYPE html>
<html xmlns:h="http://java.sun.com/jsf/html" 
	  xmlns:f="http://java.sun.com/jsf/core"
	  xmlns:c="http://java.sun.com/jsp/jstl/core"
	  xmlns:ui="http://java.sun.com/jsf/facelets">
<h:head>
	<title>Create Order</title>
</h:head>
<h:body>
<f:view>
<c:if test="${customer.current ne null}"> 
	<h1>Create order</h1>
	<h:form>
		<a href="CustomerHome.xhtml">Home</a>
		<br/>
		<h:commandLink value="create new"  action="#{createOrderController.createNewOrder}" /> <br/>
		<h:commandLink value="close order" rendered = "#{createOrderController.order ne null}" action="#{createOrderController.closeOrder}" /> <br/>
		<h:commandLink value="save order"  rendered = "#{createOrderController.order ne null}" action="#{createOrderController.saveOrder}" /> <br/>
	</h:form>
	<div style="display: inline-block; vertical-align: top">	
		<h2> Catalog </h2>
		<h3> choose a product and perform an action</h3>
		<h:dataTable value="${productController.productCatalog}" var="product">
			<h:column>
				<f:facet name="header">
					<h:outputText value="Code"/>
				</f:facet>
				<h:outputText value="${product.code}"/>
			</h:column>
			<h:column>
				<f:facet name="header">
					<h:outputText value="Name"/>
				</f:facet>
				<h:outputText value="${product.name}"/>
			</h:column>
			<h:column>
				<f:facet name="header">
					<h:outputText value="Price"/>
				</f:facet>
				<h:outputText value="${product.price}"/>
			</h:column>
			<h:column>
				<f:facet name="header">
					<h:outputText value="Description"/>
				</f:facet>
				<h:outputText value="${product.description}"/>
			</h:column>
				<h:column>
				<f:facet name="header">
					<h:outputText value="Action"/>
				</f:facet>
				<h:form>
					<h:commandButton value="+" disabled="#{createOrderController.order eq null}" action="#{createOrderController.addProductUnit(product.code)}" />
					<h:commandButton value="-" disabled="#{createOrderController.order eq null}" action="#{createOrderController.removeProductUnit(product.code)}" />
				</h:form>
			</h:column>
		</h:dataTable>
	</div>
	<div style="display:inline-block; vertical-align: top; margin-left: 5%">
	<h2>Actual Order</h2>
	<h3>Total: ${createOrderController.order.total} €</h3>
	<h:dataTable value="${createOrderController.order.orderLines}" var="orderLine">
		<h:column>
			<f:facet name="header">
				<h:outputText value = "Product" />
			</f:facet>
			<h:outputText value="${orderLine.product.name}"/>
		</h:column>
		<h:column>
			<f:facet name="header">
				<h:outputText value = "Quantity" />
			</f:facet>
			<h:outputText value="${orderLine.quantity}" />
		</h:column>
		<h:column>
			<f:facet name="header">
				<h:outputText value = "Price" />
			</f:facet>
			<h:outputText value="${orderLine.price} €" />
		</h:column>
	</h:dataTable>
	</div>
</c:if> 
</f:view>
</h:body>
</html>